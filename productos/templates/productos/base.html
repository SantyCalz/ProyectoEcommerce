{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}E-commerce{% endblock %}</title>

    <!-- ======================================================
         CSS principal y librerías
         ====================================================== -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
          integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Bloque adicional de head para cada template -->
    {% block head %}{% endblock %}
</head>
<body>

    <!-- ======================================================
         NAVBAR
         - Enlaces a productos, carrito y cuenta
         - Cambia según si el usuario está autenticado
         - Íconos con tooltip (title) para mejor accesibilidad
    ====================================================== -->
    <nav class="navbar">
        <div class="navbar-left">
            <a href="{% url 'lista_productos' %}" class="nav-link">Productos</a>
        </div>

        <div class="navbar-center">
            <img src="{% static 'img/Logo.gif' %}" alt="Logo" class="navbar-logo">
        </div>

        <div class="navbar-right">
            {% if user.is_authenticated %}
                <!-- Usuario logueado: acceso a carrito, cuenta y logout -->
                <a href="{% url 'ver_carrito' %}" class="icon-link" title="Ver carrito">
                    <i class="fas fa-shopping-cart"></i>
                </a>
                <a href="{% url 'mi_cuenta' %}" class="icon-link" title="Mi cuenta">
                    <i class="fas fa-user"></i>
                </a>
                <a href="{% url 'logout_usuario' %}" class="icon-link" title="Cerrar sesión">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            {% else %}
                <!-- Usuario no logueado: login y registro -->
                <a href="{% url 'login_usuario' %}" class="icon-link" title="Iniciar sesión">
                    <i class="fas fa-sign-in-alt"></i>
                </a>
                <a href="{% url 'registro' %}" class="icon-link" title="Registrarse">
                    <i class="fas fa-user-plus"></i>
                </a>
            {% endif %}
        </div>
    </nav>

    <!-- ======================================================
         BLOQUE DE MENSAJES
         - Muestra feedback al usuario: éxito, error, advertencia o info
         - Se cierra automáticamente con el botón "x"
         - Feedback agregado: cualquier acción en backend que genere mensajes
           (ej: producto agregado al carrito, login incorrecto, pedido exitoso)
    ====================================================== -->
    <div class="container mt-3">
        {% if messages %}
            {% for message in messages %}
                <div class="alert 
                    {% if message.tags == 'error' %}alert-danger
                    {% elif message.tags == 'success' %}alert-success
                    {% elif message.tags == 'warning' %}alert-warning
                    {% else %}alert-info{% endif %} 
                    alert-dismissible fade show" role="alert">
                    
                    {{ message }} <!-- Mensaje dinámico enviado desde views.py -->
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <!-- ======================================================
         CONTENIDO PRINCIPAL
         - Cada template insertará aquí su contenido
         - Feedback: los templates hijos pueden mostrar alertas
           dentro de este bloque, por ejemplo al agregar un producto
           al carrito o al filtrar productos
    ====================================================== -->
    <main class="container mt-4">
        {% block content %}{% endblock %}
    </main>

    <!-- ======================================================
         FOOTER
         - Información institucional y link a GitHub
         - Separa visualmente en izquierda, centro y derecha
         - No requiere feedback
    ====================================================== -->
    <footer class="footer-navbar">
        <div class="footer-left">
            <a href="{% url 'lista_productos' %}" class="footer-logo">
                <img src="{% static 'img/Logo.gif' %}" alt="Logo" />
            </a>
        </div>
        <div class="footer-center">
            <p>
                Proyecto final de la Tecnicatura en Programación - UTN San Rafael. Grupo CodeX5.
            </p>
        </div>
        <div class="footer-right">
            <a class="btn-github" href="https://github.com" target="_blank">
                <i class="fab fa-github"></i> GitHub
            </a>
        </div>
    </footer>

    <!-- ======================================================
         JS de Bootstrap
         - Permite alertas interactivas y componentes dinámicos
         - Scripts adicionales se pueden agregar desde templates hijos
    ====================================================== -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}

</body>
</html>
